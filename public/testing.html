<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
      <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
  <script src="config.js"></script> <!-- Firebase config file -->


</head>
<body>
    
    <script>
            firebase.initializeApp(firebaseConfig);

        const db = firebase.firestore();  // Access Firestore using the compat syntax
          
          console.log("userdata")
          // Listen for authentication state changes to ensure user is logged in
          firebase.auth().onAuthStateChanged((user) => {
            if (user) {
              const uid = user.uid;  // Get the logged-in user's UID
              console.log(uid)
              // Query Firestore to get data from 'userQuestionnaire' for this UID
              db.collection('UserQuestionnaire')
                .where('uid', '==', uid)
                .get()
                .then((querySnapshot) => {
          
                  if (querySnapshot.empty) {
                    console.log("No document found in userQuestionnaire for UID:", uid);  // Log if no document exists
                  } else {
                    querySnapshot.forEach((doc) => {
                      const data = doc.data();  // Get the document data
                      console.log("User data found:", data);  // Log fetched data

                      // Store the user's data in the Vue instance
                      this.userQuestionnaireData = {
                        uid: data.uid,  // Store the user's UID
                        interests: data.interests || [],  // Array of interests
                        skills: data.skills || [],  // Array of skills
                        location: data.location || 'No location'  // Location (e.g., postal code)
                      };

                      // Set the match bar to visible
                      this.showMatchBar = true;
                    });
                  }
                })
                .catch((error) => {
                  console.error("Error fetching user data:", error);
                });
            } else {
              console.log("No user is logged in.");
            }
          });
    </script>
</body>
</html>