<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Volunteer Questionnaire</title>
		<!-- bootstrap -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<!-- Vue.js 3.2.37 Script -->
		<script src="https://cdn.jsdelivr.net/npm/vue@3.2.37/dist/vue.global.min.js"></script>
		<link rel="stylesheet" href="questionnaire.css" />
		<!-- Firebase SDK -->
		<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
		<script src="../config.js"></script>
	</head>

	<body>
		<div id="app">
			<!-- Progress Bar at the Top -->
			<div class="progress-container" style="margin-top: 10px;">
				<div class="progress-bar" :style="{ width: progress + '%' }"></div>
			</div>
	
			<h2 class="text-center question" style="margin-top: 4%">
				{{ questions[currentStep - 1] }}
			</h2>
	
			<!-- Message bar for displaying success or error notifications -->
			<div v-if="showMessageBar" class="message-bar">
				{{ submissionMessage }}
			</div>
	
			<div class="myContainer">
				<!-- Interests Page -->
				<div v-if="currentStep === 1" class="form-page active">
					<div class="centered-options">
						<div
							v-for="interest in interestsList"
							:key="interest"
							class="option-item"
						>
							<button
								class="btn-custom"
								:class="{ active: formData.interests.includes(interest) }"
								@click="toggleInterest(interest)"
							>
								{{ interest }}
							</button>
						</div>
					</div>
					<!-- Buttons at the Bottom -->
					<div class="btn-group">
						<hr />
						<button
							class="btn-custom btn-next"
							@click="nextStep"
							:disabled="formData.interests.length === 0"
						>
							Next
						</button>
					</div>
				</div>
	
				<!-- Skills Page -->
				<div v-if="currentStep === 2" class="form-page active">
					<div class="centered-options">
						<div
							v-for="skill in skillsList"
							:key="skill"
							class="form-check mb-2"
						>
							<button
								class="btn-custom"
								:class="{ active: formData.skills.includes(skill) }"
								@click="toggleSkill(skill)"
							>
								{{ skill }}
							</button>
						</div>
					</div>
					<div class="btn-group">
						<hr />
						<button class="btn-custom btn-prev" @click="prevStep">Back</button>
						<button
							class="btn-custom btn-next"
							@click="nextStep"
							:disabled="formData.skills.length === 0"
						>
							Next
						</button>
					</div>
				</div>
	
				<!-- Availability Page -->
				<div v-if="currentStep === 3" class="form-page active">
					<div class="centered-options">
						<div v-for="day in daysOfWeek" :key="day" class="form-check mb-2">
							<button
								class="btn-custom"
								:class="{ active: formData.availability.includes(day) }"
								@click="toggleAvailability(day)"
							>
								{{ day }}
							</button>
						</div>
					</div>
					<div class="btn-group">
						<hr />
						<button class="btn-custom btn-prev" @click="prevStep">Back</button>
						<button
							class="btn-custom btn-next"
							@click="nextStep"
							:disabled="formData.availability.length === 0"
						>
							Next
						</button>
					</div>
				</div>
	
				<!-- Address and Postal Code Page -->
				<div v-if="currentStep === 4" class="form-page active">
					<div class="mb-3">
						<label for="address" class="form-label">Full Address (optional)</label>
						<input
							type="text"
							v-model="formData.address"
							class="form-control"
							placeholder="Enter your address"
						/>
					</div>
					<div class="mb-3">
						<label for="postalCode" class="form-label">Postal Code (required)</label>
						<input
							type="text"
							v-model="formData.postalCode"
							class="form-control"
							placeholder="Enter your postal code"
							@blur="validatePostalCode"
							required
						/>
						<p class="error text-danger" v-if="postalCodeError">
							{{ postalCodeError }}
						</p>
					</div>
					<div class="btn-group">
						<hr />
						<button class="btn-custom btn-prev" @click="prevStep">Back</button>
						<button class="btn-submit" @click="submitForm">Submit</button>
					</div>
				</div>
			</div>
		</div>
	</body>
	

		<script>
			const app = Vue.createApp({
				data() {
					return {
						submissionMessage: "",
						showMessageBar: false,
						currentStep: 1,
						formData: {
							interests: [],
							skills: [],
							availability: [],
							address: "",
							postalCode: "",
						},
						postalCodeError: "",
						isPostalCodeValid: false,
						interestsList: [
							"Environmental",
							"Community Development",
							"Education",
							"Healthcare",
							"Animal Welfare",
							"Disaster Relief",
							"Youth Services",
							"Senior Care",
							"Human Rights",
							"Sports Coaching",
							"Poverty Alleviation",
							"Homelessness",
							"Cultural Heritage",
							"Mental Health",
							"Advocacy",
						],
						skillsList: [
							"First Aid/CPR",
							"Teaching",
							"Public Speaking",
							"Fundraising",
							"Event Planning",
							"Communication",
							"Leadership",
							"Project Management",
							"Mentoring/Coaching",
							"Social Media Management",
							"Grant Writing",
							"Graphic Design",
							"Web Development",
							"Data Analysis",
							"Tutoring",
							"Photography/Videography",
							"Technical Support",
							"Healthcare Assistance",
							"Food Preparation",
							"Marketing",
						],
						daysOfWeek: [
							"Monday",
							"Tuesday",
							"Wednesday",
							"Thursday",
							"Friday",
							"Saturday",
							"Sunday",
						],
						questions: [
							"Now letâ€™s find the best place to start! What are your main interests?",
							"Now what are your main skills?",
							"What are your available days?",
							"To help us match you with the nearest and most suitable volunteering opportunities, please provide your home location.",
						],
					};
				},
				computed: {
					progress() {
						return (this.currentStep / this.questions.length) * 100;
					},
				},
				methods: {
					nextStep() {
						if (this.currentStep < this.questions.length) {
							this.currentStep++;
						}
					},
					prevStep() {
						if (this.currentStep > 1) {
							this.currentStep--;
						}
					},
					validatePostalCode() {
						const postalCodePattern = /^[0-9]{6}$/;
						if (!postalCodePattern.test(this.formData.postalCode)) {
							this.postalCodeError = "Postal code must be exactly 6 digits.";
							this.isPostalCodeValid = false;
						} else {
							this.postalCodeError = "";
							this.isPostalCodeValid = true;
						}
					},
					submitForm() {
						this.validatePostalCode();
						if (this.isPostalCodeValid) {
							// Firebase Firestore submission logic here
							this.showMessageBar = true;
							this.submissionMessage = "Form successfully submitted!";
							setTimeout(() => {
								this.showMessageBar = false;
							}, 3000);
						}
					},
					toggleInterest(interest) {
						if (this.formData.interests.includes(interest)) {
							this.formData.interests = this.formData.interests.filter(
								(i) => i !== interest
							);
						} else {
							this.formData.interests.push(interest);
						}
					},
					toggleSkill(skill) {
						if (this.formData.skills.includes(skill)) {
							this.formData.skills = this.formData.skills.filter(
								(s) => s !== skill
							);
						} else {
							this.formData.skills.push(skill);
						}
					},
					toggleAvailability(day) {
						if (this.formData.availability.includes(day)) {
							this.formData.availability = this.formData.availability.filter(
								(d) => d !== day
							);
						} else {
							this.formData.availability.push(day);
						}
					},
				},
			});
			app.mount("#app");
		</script>
	</body>
</html>
